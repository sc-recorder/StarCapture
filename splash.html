<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>StarCapture - Loading</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #0d0d0d;
            color: #ffffff;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
            user-select: none;
        }
        
        .splash-container {
            text-align: center;
            animation: fadeIn 0.5s ease;
            padding: 40px;
            padding-bottom: 60px; /* Extra padding to avoid version overlap */
        }
        
        .logo {
            width: 400px;
            height: 400px;
            margin-bottom: 40px;
            object-fit: contain;
            background: transparent;
        }
        
        video.logo {
            /* Ensure video plays properly */
            pointer-events: none;
        }
        
        .loading-text {
            font-size: 1.3rem;
            color: #4a9eff;
            margin-bottom: 15px;
            letter-spacing: 2px;
            font-weight: 500;
        }
        
        .loading-dots {
            display: inline-block;
            width: 60px;
            text-align: left;
        }
        
        .status-text {
            font-size: 0.95rem;
            color: #888;
            margin-bottom: 30px;
            min-height: 20px;
            transition: color 0.3s ease;
        }
        
        .status-text.active {
            color: #4a9eff;
        }
        
        .loading-bar-container {
            width: 350px;
            height: 5px;
            background: #1a1a1a;
            border-radius: 3px;
            overflow: hidden;
            margin: 0 auto;
            margin-bottom: 20px;
        }
        
        .loading-bar {
            height: 100%;
            background: linear-gradient(90deg, #4a9eff, #6ab7ff);
            width: 30%;
            border-radius: 2px;
            animation: loadingBar 2s infinite;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.9; }
        }
        
        @keyframes loadingBar {
            0% { width: 0%; transform: translateX(0); }
            50% { width: 100%; transform: translateX(0); }
            100% { width: 100%; transform: translateX(100%); }
        }
        
        .version {
            position: fixed;
            bottom: 15px;
            font-size: 0.75rem;
            color: #555;
            left: 0;
            right: 0;
            text-align: center;
            z-index: 10;
        }
    </style>
</head>
<body>
    <div class="splash-container">
        <img src="images/logo-optimized.gif" alt="StarCapture" class="logo">
        <div class="loading-text">
            INITIALIZING<span class="loading-dots">...</span>
        </div>
        <div class="status-text" id="status-text">
            Preparing application...
        </div>
        <div class="loading-bar-container">
            <div class="loading-bar" id="loading-bar"></div>
        </div>
    </div>
    <div class="version" id="version">v0.1.0</div>

    <script>
        const { ipcRenderer } = require('electron');

        // Get version from main process
        ipcRenderer.invoke('get-app-version').then(version => {
            document.getElementById('version').textContent = `v${version}`;
        });
        
        // Animate loading dots
        const dots = document.querySelector('.loading-dots');
        let dotCount = 0;
        setInterval(() => {
            dotCount = (dotCount + 1) % 4;
            dots.textContent = '.'.repeat(dotCount);
        }, 500);
        
        // Update loading progress
        ipcRenderer.on('splash-progress', (event, data) => {
            const statusText = document.getElementById('status-text');
            const loadingBar = document.getElementById('loading-bar');
            
            if (data.message) {
                statusText.textContent = data.message;
                statusText.classList.add('active');
                setTimeout(() => statusText.classList.remove('active'), 300);
            }
            
            if (data.progress !== undefined) {
                const progress = Math.min(100, Math.max(0, data.progress));
                loadingBar.style.width = progress + '%';
            }
        });
    </script>
</body>
</html>